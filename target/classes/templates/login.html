<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>登录</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
    <link rel="stylesheet" th:href="@{/css/typo.css}">
    <link rel="stylesheet" th:href="@{/lib/editor/css/editormd.css}">
    <link rel="stylesheet" th:href="@{/lib/prism/prism.css}">
    <link rel="stylesheet" th:href="@{/lib/tocbot/tocbot.css}">
    <!--引入自定义的css-->
    <link rel="stylesheet" th:href="@{/css/me.css}">
    <link rel="stylesheet" th:href="@{/css/login.css}">
    <link rel="stylesheet" th:href="@{/css/background.css}">

</head>
<body>


<div class="container" id="container">
    <div class="form-container sign-up-container">
        <form id="formReg" action="#" method="post" enctype="multipart/form-data">
            <div class="social-container">
                <!--                <a href="#" class="social"><i class="fab fa-facebook-f"></i></a>-->
                <!--                <a href="#" class="social"><i class="fab fa-google-plus-g"></i></a>-->
                <!--                <a href="#" class="social"><i class="fab fa-linkedin-in"></i></a>-->
                <img th:src="@{/images/Volcano.jpg}"
                     width="100" height="100" id="imgs" class="border border-primary"
                     style="margin-bottom: 5px;
                     border-radius: 100%"
                     th:onclick="chooseImageFile('pic')">
                <input type="file" name="imgFile" id="pic" hidden="hidden" accept="image/*"
                       th:onchange="showImg('pic')">
            </div>
            <span th:onclick="chooseImageFile('pic')">点击图片以上传你的头像</span>
            <input type="text" id="nickname" name="nickname" th:onclick="test()" placeholder="昵称"/>
            <input type="text" id="username" name="username" placeholder="用户名 (6至20位字母，数字，下划线)"/>
            <input type="password" id="password" name="password" placeholder="密码 (6至18位字母，数字)"/>
            <input type="email" id="email" name="email" placeholder="请输入邮箱"/>
            <input type="hidden" id="type" name="type" th:value="2">
            <a class="ui button" id="regButton">注册</a>
            <text id="errorMsg" style="color: red"></text>
        </form>
    </div>
    <div class="form-container sign-in-container">
        <form th:action="@{/logIn}" method="post">
            <h1>登录</h1>
            <div class="social-container">
                <a href="#" class="social"><i class="fab fa-facebook-f"></i></a>
                <a href="#" class="social"><i class="fab fa-google-plus-g"></i></a>
                <a href="#" class="social"><i class="fab fa-linkedin-in"></i></a>
            </div>
            <span>or use your account</span>
            <input type="text" name="username" placeholder="用户名"/>
            <input type="password" name="password" placeholder="密码"/>
            <a href="#">Forgot your password?</a>
            <button type="submit">登录</button>
        </form>
    </div>
    <div class="overlay-container">
        <div class="overlay">
            <div class="overlay-panel overlay-left">
                <h1>Welcome Back!</h1>
                <p>To keep connected with us please login with your personal info</p>
                <button class="ghost" id="signIn">Sign In</button>
            </div>
            <div class="overlay-panel overlay-right">
                <h1>Hello, Friend!</h1>
                <p>Enter your personal details and start journey with us</p>
                <button class="ghost" id="signUp">Sign Up</button>
            </div>
        </div>
    </div>
</div>


<!--/*/<th:block th:replace="_fragments :: script">/*/-->
<!--引入jquery-->
<script src="http://code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>

<!--/*/</th:block>/*/-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/js/all.min.js"
        integrity="sha256-qM7QTJSlvtPSxVRjVWNM2OfTAz/3k5ovHOKmKXuYMO4=" crossorigin="anonymous"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/jquery.form/4.0.1/jquery.form.js"></script>


<script th:src="@{/js/login.js}"></script>

<script>
    // 打开file表单,选择图片
    function chooseImageFile(inputFileId) {
        $("#" + inputFileId).click();
    }

    // FileReader接口提供了一个异步的API，通过这个API可以从浏览器中异步访问文件系统中的数据。
    // 因此，FileReader接口可以读取文件中的数据，并将读取的数据放入到内存中去
    var imgReader = new FileReader();

    // 正则表达式，过滤图片文件
    regexImageFilter = /^(?:image\/bmp|image\/cis\-cod|image\/gif|image\/ief|image\/jpeg|image\/jpeg|image\/jpeg|image\/pipeg|image\/png|image\/svg\+xml|image\/tiff|image\/x\-cmu\-raster|image\/x\-cmx|image\/x\-icon|image\/x\-portable\-anymap|image\/x\-portable\-bitmap|image\/x\-portable\-graymap|image\/x\-portable\-pixmap|image\/x\-rgb|image\/x\-xbitmap|image\/x\-xpixmap|image\/x\-xwindowdump)$/i;

    function showImg(inputFileId) {
        // 获取图片
        var imgFile = $("#" + inputFileId).get(0).files[0];
        // 判断上传文件是否为图片
        if (!regexImageFilter.test(imgFile.type)) {
            console.log("请输入正确图片格式！");
        } else {
            imgReader.readAsDataURL(imgFile);
        }
        var imgFile0 = new FormData($("#formReg")[0]);
        imgFile0.append('imgFile', $("#pic")[0].files[0]);
        $.ajax({
            url: 'upLoadImg',
            type: 'post',
            data: imgFile0,
            // 告诉jQeury不处理发送的数据
            processData: false,
            // 不设置Content-Type的请求头
            contentType: false,
            async: false,
            cache: false,
            success: function () {

            }
        });
    }

    // 读取图片
    imgReader.onload = function (evt) {
        $("#imgs").attr("src", evt.target.result);
    };



    $("#regButton").click(function () {
        var nickname = $("#nickname").val();
        var username = $("#username").val();
        var password = $("#password").val();
        var email = $("#email").val();
        var type = $("#type").val();

        $.post({
            url: "registration",
            data: {
                "nickname": nickname,
                "username": username,
                "password": password,
                "email": email,
                "type": type
            },
            success: function () {

            }
        })
    });

    // $("#regButton").click(function () {
    //     var nickname = $("#nickname").val(),
    //         username = $("#username").val(),
    //         password = $("#password").val(),
    //         email = $("#email").val(),
    //         type = $("#type").val();
    //
    //     $.ajax({
    //         url: 'registration',
    //         type: 'post', // 提交方式
    //         data: {
    //             'nickname': nickname,
    //             'username': username,
    //             'password': password,
    //             'email': email,
    //             'type': type
    //         },
    //         success: function () {
    //             if (data.trim() == "ok") {
    //                 $("#signIn").click();
    //             } else if (data.trim() == "error") {
    //                 // $("#errorMsg").setAttribute()
    //                 $("#errorMsg").html("用户名或密码格式错误");
    //
    //             }
    //             console.log("came to success");
    //             $("#signIn").click();
    //         }
    //     });
    // });


    function test() {
        var testData = "Mark";
        $.ajax({
            url: "test",
            type: 'post',
            data: {
                'testData': testData
            },
            success: function (data) {
                console.log(data);
            }
        })
    }

    // $("#regButton").click(function dataSubmit() {
    //     $('#formReg').on('submit', function () {
    //         var imgFile = new FormData($("#formReg")[0]);
    //         imgFile.append('imgFile', $("#pic")[0].files[0]);
    //         var nickname = $("#nickname").val(),
    //             username = $("#username").val(),
    //             password = $("#password").val(),
    //             type = $("#type").val(),
    //             email = $("#email").val();
    //
    //         console.log(nickname);
    //         console.log(username);
    //
    //         $.ajax({
    //             url: 'upLoadImg',
    //             type: 'post',
    //             data: imgFile,
    //             // 告诉jQeury不处理发送的数据
    //             processData: false,
    //             // 不设置Content-Type的请求头
    //             contentType: false,
    //             async: false,
    //             cache: false,
    //             success: function () {
    //                 $(this).ajaxSubmit({
    //                     type: 'post', // 提交方式
    //                     url: 'registration',
    //                     data: {
    //                         'nickname': nickname,
    //                         'username': username,
    //                         'password': password,
    //                         'email': email,
    //                         'type': type
    //                     },
    //                     processData: true,
    //                     contentType: true,
    //                     async: true,
    //                     cache: true,
    //                     success: function (data) {
    //                         if (data.trim() == "ok") {
    //                             $("#signIn").click();
    //                         } else {
    //                             // $("#errorMsg").setAttribute()
    //                             $("#errorMsg").html("用户名或密码格式错误");
    //
    //                         }
    //                     }
    //                 });
    //             }
    //         });
    //
    //
    //         return false;
    //     });
    // });


</script>
</body>


</html>